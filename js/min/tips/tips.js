(function(A,C){var B=function(D,E){E=A.extend({json:"",template:"",url:null,datatype:null,view:null,type:"bottom"},E);this.target=A(D);this.init(E);};B.prototype={init:function(D){this.target.data("__loaded__",true);this.setOptions(D);this.bindEvent();},setOptions:function(D){A.extend(this,D);this.isCreate=true;this.json=this.json||this.target.data("json");this.template=this.template||A("#"+this.target.data("template")).val();this.url=this.url||this.target.data("url");this.datatype=this.datatype||this.target.data("datatype");this.type=this.target.data("type")||this.type;},bindEvent:function(){var D=this;this.target.on("mousemove",function(){if(D.isCreate){if(D.url&&!D.json){D.isCreate=false;A.ajax({url:D.url,type:"get",dataType:D.datatype,success:function(E){if(A.type(E)==="object"){D.json=E;}else{D.json=A.parseJSON(E);}D.createHtml();}});}else{D.isCreate=false;D.createHtml();}}});A(document).on("mousemove",function(E){if(D.view){if(!D.hasParent(D.getToElement(E),[D.view[0],D.target[0]])){D.clearHtml();}}});},bindViewEvent:function(){var D=this;this.view.on("mouseout",function(E){if(!D.hasParent(D.getToElement(E),[D.view[0],D.target[0]])){D.clearHtml();}});},getToElement:function(E){var D;if(E.type=="mouseout"){D=E.relatedTarget||E.toElement;}else{if(E.type=="mouseover"){D=E.target;}else{D=E.target;}}if(!D){return;}while(D.nodeType!=1){D=D.parentNode;}return D;},hasParent:function(G,F){var I=G,D=false;if(I!=null){for(var H=0,J=F.length;H<J;H++){if(F[H]==I){return true;}}while(I.parentNode!=null){I=I.parentNode;for(var E=0,J=F.length;E<J;E++){if(F[E]==I){return true;}}}}return D;},createHtml:function(){this.view=A(A.template.replace(this.template,this.json));$$.container.append(this.view);this.view.cover();this.view.css("position","absolute").css(this.getPostion());},clearHtml:function(){this.view.uncover();this.view.remove();this.isCreate=true;},getPostion:function(){var D=this.target.offset(),G=D,H=(this.view.width()/2)-(Math.max(this.target.width(),this.target[0].offsetWidth)/2),F=this.view[0].offsetHeight,E=this.target[0].offsetHeight;switch(this.type){case"top":G.left=D.left-H;G.top=D.top-F;break;case"bottom":G.left=D.left-H;G.top=D.top+E;break;case"left-bottom":G.left=D.left-(this.view.width()-Math.max(this.target.width(),this.target[0].offsetWidth));G.top=D.top+E;break;case"right-bottom":G.left=D.left;G.top=D.top+E;break;}return G;}};A.fn.extend({Tips:function(D){if(A(this).data("__loaded__")==C){var E={};if(typeof D!=="undefined"){A.extend(true,E,D);}B["instance"]=new B(this,E);return B["instance"];}}});A.extend({TipsAll:function(){A("[data-role='page']").on("mousemove","[data-role='tips']",function(){A(this).Tips();});}});})(jQuery);