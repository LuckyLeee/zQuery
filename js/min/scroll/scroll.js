(function(A,B){if(!Function.prototype.bind){Function.prototype.bind=function(D){if(typeof this!=="function"){A.error("Function.prototype.bind - what is trying to be bound is not callable");}var F=Array.prototype.slice.call(arguments,1),G=this,H=function(){},E=function(){return G.apply(this instanceof H&&D?this:D||window,F.concat(Array.prototype.slice.call(arguments)));};H.prototype=this.prototype;E.prototype=new H();return E;};}var C=function(D,E){E=A.extend({showTop:null,panel:null,className:null,callback:{lower:null,change:null,bottom:null},distanceBottom:0,size:{top:0,bottom:0,left:0,width:0,height:0},initTop:null,initMaxTop:0,anchor:{list:null,className:"on",isOffset:false}},E);this.target=A(D);this.init(E);};C.prototype={init:function(D){this.setOptions(D);this.bindEvent();},setOptions:function(D){A.extend(this,D);this.size.height=this.target.height();this.size.width=this.target.width();this.size.left=this.target.offset().left;this.initTop=this.initTop===0?0:this.target.offset().top;this.isAnchor=this.anchor.list!=null;if(this.isAnchor){this.initSetOptions();this.triggerAnchor(0);}},bindEvent:function(){var D=this;A(document).ready(function(){D.fire();});A(window).unbind("scroll",this.fire);A(window).unbind("resize",this.fire);A(window).bind("scroll",this.fire.bind(D));A(window).bind("resize",this.fire.bind(D));},initSetOptions:function(){var H=this;this.changeAList=new Array();this.anchorList=new Array();for(var M=0,P=this.anchor.list.length;M<P;M++){var E=A(this.anchor.list[M]).attr("href");var G=A(E);if(G){var I=this.getTop(G[0]);this.anchorList.push(I);this.changeAList.push(A(this.anchor.list[M]));}else{this.anchor.list[M].style.display="none";}}var K=this.changeAList.length;for(var Q=0,D=K-1;Q<=D;Q++){for(var N=Q+1,O=K-1;N<=O;N++){if(this.anchorList[Q]>this.anchorList[N]){var F=this.anchorList[N];this.anchorList[N]=this.anchorList[Q];this.anchorList[Q]=F;F=this.changeAList[N];this.changeAList[N]=this.changeAList[Q];this.changeAList[Q]=F;}}}for(var L=0,J=K;L<J;L++){(function(R){H.changeAList[L].bind("click",function(S){S.preventDefault?S.preventDefault():(S.returnValue=false);if(S.stopPropagation){S.stopPropagation();}window.scroll(0,H.anchorList[R]);H.autoCalcTopList();H.triggerAnchor(R);});})(L);}},autoCalcTopList:function(){this.anchorList=[];for(var E=0,G=this.changeAList.length;E<G;E++){var F=A(this.changeAList[E]).attr("href");var D=this.getTop(A(F)[0])-(this.anchor.isOffset?this.size.height:0);this.anchorList.push(D);}},triggerAnchor:function(D){for(var E=0,F=this.changeAList.length;E<F;E++){if(E==D){this.changeAList[E].addClass(this.anchor.className);}else{this.changeAList[E].removeClass(this.anchor.className);}}},fire:function(){var F=this,E;if(this.showTop){var D=A(document).scrollTop();if(D<this.showTop){F.target.trigger("hide");}else{F.target.trigger("show");}}if(E){clearTimeout(E);}E=setTimeout(function(){F.getWindowMoveScroll();},1);},getWindowMoveScroll:function(){var E=this.getScrollTop();if(E<=this.initTop){this.setOldStyle();if(this.className){this.target.removeClass(this.className[1]);this.panel.addClass(this.className[0]);}if(A.type(this.callback.lower)=="function"){this.callback.lower();}}else{if(this.className){this.panel.removeClass(this.className[0]);this.target.addClass(this.className[1]);}if(this.isMaxScrollBottom(E)){this.setFixedBottomStyle();if(A.type(this.callback.bottom)=="function"){this.callback.bottom();}}else{this.setNewStyle();if(A.type(this.callback.change)=="function"){this.callback.change();}}}if(!this.isReachBrowserBottom()&&this.isAnchor){var F=0;if(this.anchorList.length>0){this.autoCalcTopList();if(E<=this.anchorList[0]){F=0;}else{if(E>=this.anchorList[this.anchorList.length-1]){F=this.anchorList.length-1;}else{if(this.anchorList.length>1){if(E<this.anchorList[this.anchorList.length-1]&&E>=this.anchorList[this.anchorList.length-2]){F=this.anchorList.length-2;}else{for(var D=0,G=this.anchorList.length-2;D<G;D++){if(E>=this.anchorList[D]&&E<this.anchorList[D+1]){F=D;}}}}}}this.triggerAnchor(F);}}},isReachBrowserBottom:function(){var F=0,E=0,D=0;if(document.documentElement&&document.documentElement.scrollTop){F=document.documentElement.scrollTop;}else{if(document.body){F=document.body.scrollTop;}}if(document.body.clientHeight&&document.documentElement.clientHeight){E=(document.body.clientHeight<document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight;}else{E=(document.body.clientHeight>document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight;}D=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);if(F+E==D){return true;}else{return false;}},getTop:function(D){var E=D.offsetTop;if(D.offsetParent!=null){E+=arguments.callee(D.offsetParent);}return E;},isMaxScrollBottom:function(D){if(D>this.getMaxScrolHeight(false)){return true;}return false;},getMaxScrolHeight:function(F){var D=0;if(document.body.clientHeight&&document.documentElement.clientHeight){D=(document.body.clientHeight<document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight;}else{D=(document.body.clientHeight>document.documentElement.clientHeight)?document.body.clientHeight:document.documentElement.clientHeight;}var E=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);return E-(F?D:0)-this.distanceBottom-this.size.height;},getScrollTop:function(){var D=0;if(document.documentElement&&document.documentElement.scrollTop){D=document.documentElement.scrollTop;}else{if(document.body){D=document.body.scrollTop;}}return D;},setFixedBottomStyle:function(){if(this.target[0].style.position=="fixed"){this.target[0].style.top=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)-this.distanceBottom-this.target.height()-20+"px";this.target[0].style.position="absolute";this.target[0].style.bottom=this.size.bottom+"px";this.target[0].style.left="";this.target[0].style.zIndex=10000;this.target[0].style.height=this.size.height+20+"px";if($$.browser.IsIE){this.target[0].style.width=(this.size.width+1)+"px";}}},setNewStyle:function(){this.target[0].style.top=(this.size.top+this.initMaxTop)+"px";this.target[0].style.zIndex=10000;this.target[0].style.position="fixed";if($$.browser.IsIE){if($$.browser.IsIE6){this.target[0].style.position="absolute";this.target[0].style.top=(this.size.top+this.getScrollTop()+this.initMaxTop)+"px";this.target[0].style.left=this.size.left+"px";this.target[0].style.bottom=this.size.bottom+"px";}}},setOldStyle:function(){this.target[0].style.top="";this.target[0].style.left="";this.target[0].style.bottom="";this.target[0].style.zIndex="";this.target[0].style.position="";this.target[0].style.width="";this.target[0].style.display="block";}};A.fn.extend({Scroll:function(D){var E={};if(typeof D!=="undefined"){A.extend(true,E,D);}C["instance"]=new C(this,E);return C["instance"];}});})(jQuery);